
SELECT loadsession,OPERATIONDATE,distributor,Sum(numnewsta),Sum(numnewstanotcontrolled)--,numnewstanotexists,numnewstaoff,numnewstaconcat,numnewstarepeated,state,stateinfo
FROM FN3LOADREPORT
WHERE
DISTRIBUTOR='BERALAN' AND   OPERATIONDATE >= DAT('2008/01/01')
GROUP BY loadsession,OPERATIONDATE,distributor


SELECT *
FROM FN3LOADREPORT
WHERE
DISTRIBUTOR='BERALAN' AND   OPERATIONDATE >= DAT('2008/01/01')
AND delegate='PAMPLONA'
ORDER BY LOADSESSION


SELECT *
FROM FN3LOADREPORT
WHERE
LOADSESSION='20080326_NOR_200710221107_1'



SELECT DISTINCT(NEWSSTAND),DELEGATE
FROM
(
SELECT *
FROM FN3OPERATIONTMP
WHERE LOADSESSION='20080326_NOR_1'
AND NEWSSTAND IN
(
SELECT DISTINCT(NEWSSTAND) FROM FN3OPERATIONNEWSTANOTEXIST
WHERE LOADSESSION='20080326_NOR_200710221107_1')
)



SELECT t1.newsstand
FROM fn3operation t1,fn3node t2
WHERE operationdate=dat('20080318')
AND SubStr(fathernode,1,3)='LRI'
AND t1.newsstand=t2.newsstand
MINUS
(
SELECT t1.newsstand
FROM fn3newsstandon t1,fn3node t2
WHERE dateoff IS null
AND SubStr(fathernode,1,3)='LRI'
AND t1.newsstand=t2.newsstand
)


SELECT *
FROM FN3OPERATIONTMP
WHERE
LOADSESSION='20080326_NOR_200710221107_1'
AND newsstand IN
(
SELECT DISTINCT(newsstand)
FROM
(
SELECT NEWSSTAND,OPERATIONDATE,Count(*)
FROM FN3OPERATIONTMP
WHERE
LOADSESSION='20080326_NOR_200710221107_1'
GROUP BY NEWSSTAND,OPERATIONDATE
HAVING Count(*)>1)
)