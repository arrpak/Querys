CREATE TABLE FN3FUERZABACKWARD4
AS SELECT * FROM FN3FUERZAEQUIPOAUX2


CREATE TABLE FN3FUERZAFORWARD5
AS SELECT * FROM FN3FUERZAEQUIPOAUX2




DROP TABLE  FN3FUERZABACKWARD4


CREATE TABLE FN3FUERZAEQUIPOAUx5
AS SELECT * FROM FN3FUERZAEQUIPOAUx4;


CREATE INDEX   FN3FUERZAequipoaux5idx  ON   FN3FUERZAequipoaux5   (fecha,equipo);


  update     FN3FUERZAEQUIPOAUX5
SET fuerza=0
WHERE FECHA=DAT('19920304')


DELETE  FN3FUERZAEQUIPOAUX5
WHERE FECHA=DAT('19920302')



select  *
FROM FN3FUERZAEQUIPOAUX5
WHERE FECHA=DAT('19920304')
ORDER BY FUERZA desc;







CREATE TABLE FN3FUERZABACKWARD1
AS SELECT * FROM FN3FUERZAEQUIPOAUX


 CREATE TABLE FN3FUERZAFORWARD2
AS SELECT * FROM FN3FUERZAEQUIPOAUX


DROP TABLE    FN3FUERZAEQUIPOAUX





SELECT t1.fecha,t1.fuerza AS fueold,t2.fuerza AS fuenew
from
(SELECT fecha,fuerza,equipo
FROM fn3fuerzaequipo
WHERE equipo='SPA'     ) t1,
(SELECT fecha,fuerza,equipo
FROM FN3FUERZAFORWARD2
WHERE equipo='SPA'    ) t2
WHERE
t1.equipo=t2.equipo
AND t1.fecha=t2.fecha


SELECT AVG(fuerza),fecha
FROM fn3fuerzaequipoaux
GROUP BY fecha



     //

SELECT Count(equipo)
FROM fn3fuerzaequipoaux2
WHERE equipo='SBA'



INSERT INTO FN3FUERZAEQUIPOAUX2
SELECT cod,fec,-2
from
(
SELECT distinct t1.CODIGO as cod ,DAT('19920307') as fec
FROM FN3EQUIPOFUTBOL t1
WHERE tipoequipo='SEL'
MINUS
(SELECT distinct equipo,fecha  FROM FN3FUERZAEQUIPOAUX2 WHERE FECHA=DAT('19920307')))


(SELECT * FROM FN3FUERZAEQUIPO WHERE FECHA=DAT('19920306') and equipo='SPA')



UPDATE FN3EQUIPOFUTBOL SET TIPOEQUIPO='CLB' WHERE CODIGO='BLI'




SELECT *
FROM FN3PARTIDOFUTBOL
WHERE ABS(GOLESLOCAL-GOLESVISITANTE)>9
ORDER BY FECHAPARTIDO


CREATE VIEW  GOLES AS
SELECT  T1.EQUIPOLOCAL,T2.DESCRIPCION ,Avg(GOLESLOCAL-GOLESVISITANTE)
FROM FN3PARTIDOFUTBOL T1, FN3EQUIPOFUTBOL T2
WHERE
T2.TIPOEQUIPO='SEL'
AND T1.COMPETICION<>'AMISTOSO'
AND T1.EQUIPOLOCAL=T2.CODIGO
GROUP BY T1.EQUIPOLOCAL,T2.DESCRIPCION
ORDER BY 3   DESC


SELECT  T1.EQUIPOLOCAL,Round(Avg(T1.GOLESLOCAL-T1.GOLESVISITANTE),5)
FROM FN3PARTIDOFUTBOL T1,FN3EQUIPOFUTBOL T2
WHERE
T2.TIPOEQUIPO='SEL'
AND T1.COMPETICION<>'AMISTOSO'
AND T1.EQUIPOLOCAL=T2.CODIGO
GROUP BY t1.equipolocal
ORDER BY 2;









update     FN3FUERZAEQUIPOAUX3
SET fuerza=0
WHERE FECHA=DAT('19920304')
ORDER BY FUERZA;



SELECT Count(*)

UPDATE FN3PARTIDOFUTBOL
SET VALIDO ='S'
WHERE
(fechapartido,equipolocal,equipovisitante)
IN
(SELECT fechapartido,equipolocal,equipovisitante
FROM FN3PARTIDOFUTBOL T1,FN3EQUIPOFUTBOL T2
WHERE
Abs(GOLESLOCAL-GOLESVISITANTE)>5
AND TIPOEQUIPO='SEL'
AND T1.EQUIPOLOCAL=T2.CODIGO)



SELECT descripcion,fecha,fuerza
FROM FN3FUERZAEQUIPOaux3 t1,fn3equipofutbol t2
WHERE FECHA=DAT('19920309')
AND t2.codigo=t1.equipo
AND tipoequipo='SEL'
ORDER BY FUERZA DESC;



SELECT  competicion,fase,fechapartido,neutral,valido,equipolocal,equipovisitante,goleslocal,golesvisitante
FROM fn3partidofutbol
WHERE
(equipolocal='AUT' OR equipovisitante='AUT')
AND fechapartido>dat('19920101')
AND COMPETICION<>'AMISTOSO'
ORDER BY fechapartido;


SELECT (Abs(GOLESLOCAL-GOLESVISITANTE)),Count(*)
FROM FN3PARTIDOFUTBOL
WHERE
 fechapartido>dat('19920101')
 AND DOMINIO='MUN'
GROUP BY       (Abs(GOLESLOCAL-GOLESVISITANTE))

